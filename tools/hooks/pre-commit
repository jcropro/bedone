#!/bin/sh
#
# Pre-commit hook for Ember Audio Player
# Runs quality gates before allowing commits
#

echo "ğŸ”¥ Running Ember quality gates..."

# Run ktlint check
echo "ğŸ“ Running ktlint check..."
./gradlew ktlintCheck
if [ $? -ne 0 ]; then
    echo "âŒ ktlint check failed. Please fix the issues above."
    exit 1
fi

# Run detekt
echo "ğŸ” Running detekt static analysis..."
./gradlew detekt
if [ $? -ne 0 ]; then
    echo "âŒ detekt check failed. Please fix the issues above."
    exit 1
fi

# Run Android lint
echo "ğŸš¨ Running Android lint..."
./gradlew :app:lintDebug
if [ $? -ne 0 ]; then
    echo "âŒ Android lint check failed. Please fix the issues above."
    echo "ğŸ’¡ Remember: UnsafeOptInUsageError must be fixed, not baselined."
    exit 1
fi

echo "âœ… All quality gates passed! Commit allowed."
exit 0
